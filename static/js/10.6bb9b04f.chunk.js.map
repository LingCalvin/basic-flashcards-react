{"version":3,"sources":["deck/services/decks.service.ts","common/components/link.tsx","common/components/loadable-component.styles.tsx","common/components/loadable-component.tsx","router/utils/route.utils.ts","dashboard/components/deck-info-tile.styles.tsx","dashboard/components/deck-info-tile.tsx","deck/pages/deck-search.page.styles.tsx","common/utils/math.utils.ts","deck/pages/deck-search.page.tsx"],"names":["decksService","http","a","title","description","visibility","cards","this","post","authorId","authService","getCurrentUser","map","sides","frontText","text","backText","data","id","get","findOneDeckResponseToDeck","params","decks","count","put","cardId","delete","apiClient","card","tags","Link","to","color","children","component","RouterLink","useStyles","makeStyles","root","display","justifyContent","LoadableComponent","loading","className","classes","clsx","CircularProgress","deckView","theme","cursor","padding","spacing","backgroundColor","palette","action","hover","textOverflow","overflow","whiteSpace","buttonBox","deleteButton","error","dark","DeckInfoTile","numberOfCards","deckId","author","onClick","onDelete","onExport","onEdit","Paper","Typography","variant","e","stopPropagation","Button","content","paginationContainer","flexDirection","gap","paginationControls","results","clamp","min","max","value","Math","DeckSearchPage","useState","deckSlice","setDeckSlice","totalDecks","setTotalDecks","search","useLocation","qs","URLSearchParams","term","pageSizeString","pageSize","MathUtils","numberOfPages","ceil","pageString","page","from","setLoading","history","useHistory","useEffect","replace","toString","findAll","titleContains","caseInsensitive","take","skip","then","finally","deck","length","push","Pagination","onChange","_e","pathname","routes","deckSearch","encodeURIComponent","disabled"],"mappings":"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","file":"static/js/10.6bb9b04f.chunk.js","sourcesContent":["import { AxiosInstance } from 'axios';\nimport { authService } from '../../auth/services/auth.service';\nimport apiClient from '../../common/constants/api-client';\nimport Deck from '../interfaces/deck';\nimport { FindAllDecksParams } from '../interfaces/find-all-decks-params';\nimport { FindAllDecksResponse } from '../interfaces/find-all-decks-response';\nimport FindOneDeckResponse from '../interfaces/find-one-deck-response';\n\nexport class DecksService {\n  constructor(private http: AxiosInstance) {}\n\n  async create({ title, description, visibility, cards }: Deck) {\n    const { data } = await this.http.post('/decks', {\n      authorId: authService.getCurrentUser(),\n      title,\n      description,\n      visibility,\n      cards: cards.map(\n        ({ sides: [{ text: frontText }, { text: backText }] }) => ({\n          frontText,\n          backText,\n        })\n      ),\n    });\n    return data;\n  }\n\n  async findOne(id: string): Promise<Deck | null> {\n    const { data } = await this.http.get<FindOneDeckResponse>(`/decks/${id}`);\n    return findOneDeckResponseToDeck(data);\n  }\n\n  async findAll(\n    params: FindAllDecksParams\n  ): Promise<{ decks: Deck[]; count: number }> {\n    const { data } = await this.http.get<FindAllDecksResponse>(`/decks`, {\n      params,\n    });\n\n    return {\n      decks: data.decks.map(findOneDeckResponseToDeck),\n      count: data.count,\n    };\n  }\n\n  async update({ id, title, description, visibility, cards }: Deck) {\n    const { data } = await this.http.put(`/decks/${id}`, {\n      authorId: authService.getCurrentUser(),\n      title,\n      description,\n      visibility,\n      cards: cards.map(\n        ({ id: cardId, sides: [{ text: frontText }, { text: backText }] }) => ({\n          id: cardId,\n          frontText,\n          backText,\n        })\n      ),\n    });\n    return data;\n  }\n\n  async remove(id: string) {\n    return this.http.delete(`/decks/${id}`);\n  }\n}\n\nexport const decksService = new DecksService(apiClient);\n\nfunction findOneDeckResponseToDeck(data: FindOneDeckResponse): Deck {\n  const { id, authorId, title, description, visibility } = data;\n  return {\n    id,\n    authorId,\n    title,\n    description,\n    visibility,\n    cards: data.cards.map((card) => ({\n      id: card.id,\n      sides: [{ text: card.frontText }, { text: card.backText }],\n    })),\n    tags: [],\n  };\n}\n","import { Link as MuiLink, LinkProps as MuiLinkProps } from '@material-ui/core';\nimport { ReactNode } from 'react';\nimport {\n  Link as RouterLink,\n  LinkProps as RouterLinkProps,\n} from 'react-router-dom';\n\ninterface LinkProps {\n  to: RouterLinkProps['to'];\n  color?: MuiLinkProps['color'];\n  children?: ReactNode;\n}\n\nexport default function Link({ to, color, children }: LinkProps) {\n  return (\n    <MuiLink component={RouterLink} to={to} color={color}>\n      {children}\n    </MuiLink>\n  );\n}\n","import { makeStyles } from '@material-ui/core';\n\nconst useStyles = makeStyles({\n  root: {\n    display: 'flex',\n    justifyContent: 'center',\n  },\n});\n\nexport default useStyles;\n","import { CircularProgress } from '@material-ui/core';\nimport clsx from 'clsx';\nimport { ReactNode } from 'react';\nimport useStyles from './loadable-component.styles';\n\ninterface LoadableComponentProps {\n  loading?: boolean;\n  children: ReactNode;\n  className?: string;\n}\n\nexport default function LoadableComponent({\n  loading,\n  children,\n  className,\n}: LoadableComponentProps) {\n  const classes = useStyles();\n\n  return loading ? (\n    <div className={clsx(classes.root, className)}>\n      <CircularProgress />\n    </div>\n  ) : (\n    <>{children}</>\n  );\n}\n","export function deckEdit(id: string) {\n  return `/decks/${id}/edit`;\n}\n\nexport function deckView(id: string) {\n  return `/decks/${id}`;\n}\n","import { makeStyles } from '@material-ui/core';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    cursor: 'pointer',\n    padding: theme.spacing(2),\n    '&:hover': {\n      backgroundColor: theme.palette.action.hover,\n    },\n  },\n  title: {\n    textOverflow: 'ellipsis',\n    overflow: 'hidden',\n    whiteSpace: 'nowrap',\n  },\n  buttonBox: {\n    display: 'flex',\n    justifyContent: 'flex-end',\n  },\n  deleteButton: {\n    color: theme.palette.error.dark,\n  },\n}));\n\nexport default useStyles;\n","import { Button, Paper, Typography } from '@material-ui/core';\nimport Link from '../../common/components/link';\nimport useStyles from './deck-info-tile.styles';\n\ninterface DeckInfoTileProps {\n  title: string;\n  deckId: string;\n  numberOfCards: number;\n  author?: string;\n  onClick?: () => void;\n  onDelete?: () => void;\n  onExport?: () => void;\n  onEdit?: () => void;\n}\n\nexport default function DeckInfoTile({\n  title,\n  deckId,\n  numberOfCards,\n  author,\n  onClick,\n  onDelete,\n  onExport,\n  onEdit,\n}: DeckInfoTileProps) {\n  const classes = useStyles();\n  return (\n    <Paper className={classes.root} onClick={onClick}>\n      <Typography className={classes.title} variant=\"h5\" component=\"div\">\n        {title}\n      </Typography>\n      <Typography>{`${numberOfCards} cards`}</Typography>\n      {author && (\n        <Typography\n          onClick={(e: React.MouseEvent<HTMLSpanElement, MouseEvent>) =>\n            e.stopPropagation()\n          }\n          component=\"span\"\n        >\n          By <Link to={`/users/${author}`}>{author}</Link>\n        </Typography>\n      )}\n      {(onDelete || onExport || onEdit) && (\n        <div className={classes.buttonBox}>\n          {onDelete && (\n            <Button\n              className={classes.deleteButton}\n              onClick={(e) => {\n                e.stopPropagation();\n                onDelete();\n              }}\n            >\n              Delete\n            </Button>\n          )}\n          {onExport && (\n            <Button\n              onClick={(e) => {\n                e.stopPropagation();\n                onExport();\n              }}\n            >\n              Export\n            </Button>\n          )}\n          {onEdit && (\n            <Button\n              color=\"primary\"\n              onClick={(e: any) => {\n                e.stopPropagation();\n                onEdit();\n              }}\n            >\n              Edit\n            </Button>\n          )}\n        </div>\n      )}\n    </Paper>\n  );\n}\n","import { makeStyles } from '@material-ui/core';\n\nconst useStyles = makeStyles((theme) => ({\n  content: {\n    padding: theme.spacing(3),\n  },\n  paginationContainer: {\n    display: 'flex',\n    flexDirection: 'column',\n    gap: theme.spacing(2),\n  },\n  paginationControls: {\n    display: 'flex',\n    justifyContent: 'center',\n  },\n  results: {\n    display: 'flex',\n    flexDirection: 'column',\n    gap: theme.spacing(1),\n  },\n}));\n\nexport default useStyles;\n","/**\n * Returns the result of constraining an inclusive range.\n *\n * @param min - The minimum value the result can be\n * @param max - The maximum value the result can be\n * @param value - The value to constrain\n * @returns The value of `value` if `min <= value <= max`, `min` if `value < min`, and `max` if `value > max`\n */\nexport function clamp(min: number, max: number, value: number): number {\n  return Math.max(min, Math.min(max, value));\n}\n","import { Pagination } from '@material-ui/lab';\nimport { useEffect, useState } from 'react';\nimport { useHistory, useLocation } from 'react-router';\nimport LoadableComponent from '../../common/components/loadable-component';\nimport DeckInfoTile from '../../dashboard/components/deck-info-tile';\nimport routes from '../../router/constants/routes';\nimport { deckView } from '../../router/utils/route.utils';\nimport Deck from '../interfaces/deck';\nimport { decksService } from '../services/decks.service';\nimport useStyles from './deck-search.page.styles';\nimport * as MathUtils from '../../common/utils/math.utils';\n\nexport default function DeckSearchPage() {\n  const classes = useStyles();\n\n  const [deckSlice, setDeckSlice] = useState<Deck[]>([]);\n  const [totalDecks, setTotalDecks] = useState(0);\n\n  const { search } = useLocation();\n  const qs = new URLSearchParams(search);\n\n  const term = qs.get('term') ?? '';\n\n  const pageSizeString = qs.get('pageSize');\n  const pageSize = MathUtils.clamp(\n    1,\n    50,\n    pageSizeString ? +pageSizeString : 10\n  );\n\n  const numberOfPages = Math.max(1, Math.ceil(totalDecks / pageSize));\n\n  const pageString = qs.get('page');\n  const page = MathUtils.clamp(1, numberOfPages, pageString ? +pageString : 1);\n\n  const from = qs.get('from');\n\n  const [loading, setLoading] = useState(true);\n\n  const history = useHistory();\n\n  // Remove the from search param\n  useEffect(() => {\n    if (from) {\n      qs.delete('from');\n      history.replace({ search: qs.toString() });\n    }\n  });\n\n  useEffect(() => {\n    // Do not send a request if the from param is being removed\n    if (from) {\n      return;\n    }\n    if (!term) {\n      setLoading(false);\n      setDeckSlice([]);\n      return;\n    }\n    decksService\n      .findAll({\n        titleContains: term,\n        caseInsensitive: true,\n        take: pageSize,\n        skip: (page - 1) * pageSize,\n      })\n      .then(({ decks, count }) => {\n        setDeckSlice(decks);\n        setTotalDecks(count);\n      })\n      .finally(() => setLoading(false));\n  }, [from, page, pageSize, term]);\n\n  return (\n    <div>\n      <div className={classes.content}>\n        <LoadableComponent loading={loading}>\n          <div className={classes.paginationContainer}>\n            <div className={classes.results}>\n              {deckSlice.map((deck) => (\n                <DeckInfoTile\n                  key={deck.id}\n                  deckId={deck.id ?? ''}\n                  title={deck.title}\n                  numberOfCards={deck.cards.length}\n                  author={deck.authorId ?? ''}\n                  onClick={() => history.push(deckView(deck.id ?? ''))}\n                />\n              ))}\n            </div>\n            {totalDecks / pageSize > 1 && (\n              <div className={classes.paginationControls}>\n                <Pagination\n                  count={numberOfPages}\n                  page={page}\n                  onChange={(_e, value) =>\n                    history.push({\n                      pathname: routes.deckSearch,\n                      search: `?term=${encodeURIComponent(\n                        term\n                      )}&page=${encodeURIComponent(\n                        value\n                      )}&pageSize=${encodeURIComponent(pageSize)}`,\n                    })\n                  }\n                  disabled={loading}\n                />\n              </div>\n            )}\n          </div>\n        </LoadableComponent>\n      </div>\n    </div>\n  );\n}\n"],"sourceRoot":""}