(this["webpackJsonpbasic-flashcards-react"]=this["webpackJsonpbasic-flashcards-react"]||[]).push([[4],{11:function(e,t,n){"use strict";t.a={home:"/",accountSettings:"/account/settings",dashboard:"/dashboard",decks:"/decks",deckSearch:"/search",deckAdd:"/add-deck",deckEdit:"/decks/:id/edit",deckView:"/decks/:id",login:"/auth/login",registration:"/auth/register"}},126:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(8),r=n.n(c),o=(n(97),n(25)),s=n(169),i=n(33),u=n(39),l=n(15),h=n(69);function d(){var e=h.a.getCurrentUser(),t=l.a.getItem("accessToken");return e&&t?Object(u.a)(Object(u.a)({},e),{},{accessToken:t}):null}var j=n(137),b=n(130),p=n(160),O=n(171),f=n(172),m=n(161),v=n(162),g=n(129),x=n(173),k=n(163),w=n(166),y=n(167),S=n(164),C=n(165),I=n(4),T=n(9),P=n(26),N=n(40),B=n(78),z=n(11),E=n(29),L=n(157),U=Object(L.a)((function(e){var t;return{button:{whiteSpace:"nowrap"},homeLink:{textTransform:"none"},titleContainer:{flexGrow:1},avatarButton:{padding:e.spacing(.5)},avatarText:{fontSize:e.typography.h5.fontSize,fontWeight:e.typography.fontWeightBold},menuUsername:{textAlign:"center",padding:e.spacing(1),fontWeight:e.typography.fontWeightBold},searchBar:(t={},Object(E.a)(t,e.breakpoints.down("xs"),{width:"100%"}),Object(E.a)(t,"maxWidth","600px"),Object(E.a)(t,"width","100%"),t),searchBarInput:Object(E.a)({paddingLeft:e.spacing(1),paddingRight:e.spacing(1),paddingTop:e.spacing(.5),paddingBottom:e.spacing(.5),width:"100%"},e.breakpoints.down("xs"),{paddingRight:0}),toolbar:{gap:e.spacing(1)}}})),A=n(2);function F(){var e=U(),t=Object(T.h)(),n=Object(B.a)(),c=Object(a.useState)(null),r=Object(o.a)(c,2),s=r[0],u=r[1],l=Object(a.useContext)(i.a),h=function(){return u(null)},d=Object(T.g)(),E=Object(a.useState)(!1),L=Object(o.a)(E,2),F=L[0],W=L[1],R=Object(a.useState)(""),J=Object(o.a)(R,2),D=J[0],M=J[1],V=new URLSearchParams(t.search).get("from"),q=null!==V&&void 0!==V?V:z.a.home,G=Object(A.jsxs)(j.a,{open:null!==s,anchorEl:s,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},getContentAnchorEl:void 0,onClose:h,children:[Object(A.jsx)(b.a,{className:e.menuUsername,children:null===l||void 0===l?void 0:l.username.toLocaleUpperCase()}),Object(A.jsx)(p.a,{}),Object(A.jsx)(O.a,{onClick:function(){h(),d.push(z.a.accountSettings)},children:"Manage account"}),Object(A.jsx)(O.a,{onClick:function(){u(null),N.a.logOut().then((function(){return d.push(z.a.home)}))},children:"Sign out"})]}),$=Object(A.jsx)(f.a,{children:Object(A.jsx)(b.a,{className:e.avatarText,component:"div",children:null===l||void 0===l?void 0:l.username.substring(0,1).toLocaleUpperCase()})}),H=N.a.isAuthenticated()?Object(A.jsx)(m.a,{className:e.avatarButton,color:"inherit",onClick:function(e){return u(e.currentTarget)},children:$}):Object(A.jsx)(v.a,{className:e.button,component:P.b,to:z.a.login,color:"inherit",children:"Log in"}),K=Object(A.jsx)(g.a,{className:e.searchBar,children:Object(A.jsx)("form",{onSubmit:function(e){e.preventDefault(),d.push({pathname:z.a.deckSearch,search:"?from=".concat(encodeURIComponent(t.pathname),"&term=").concat(encodeURIComponent(D))})},children:Object(A.jsx)(x.a,{value:D,autoFocus:n,fullWidth:n,placeholder:"Search",className:e.searchBarInput,startAdornment:Object(A.jsx)(k.a,{position:"start",children:Object(A.jsx)(S.a,{})}),endAdornment:n?Object(A.jsx)(k.a,{position:"end",children:Object(A.jsx)(m.a,{"aria-label":"close search",onClick:t.pathname===z.a.deckSearch?function(){W(!1),M(""),d.push(q)}:function(){W(!1),M("")},children:Object(A.jsx)(C.a,{})})}):void 0,onChange:function(e){return M(e.target.value)}})})}),Q=Object(A.jsx)(w.a,{className:e.toolbar,children:t.pathname===z.a.deckSearch||F?K:Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("div",{className:e.titleContainer,children:Object(A.jsx)(v.a,{color:"inherit",component:P.b,to:z.a.home,className:Object(I.a)(e.button,e.homeLink),children:Object(A.jsx)(b.a,{variant:"h6",component:"span",children:"Basic Flashcards"})})}),Object(A.jsx)(m.a,{"aria-label":"toggle search",color:"inherit",onClick:function(){return W(!0)},children:Object(A.jsx)(S.a,{})}),H]})}),X=Object(A.jsxs)(w.a,{className:e.toolbar,children:[Object(A.jsx)("div",{className:e.titleContainer,children:Object(A.jsx)(v.a,{color:"inherit",component:P.b,to:z.a.home,className:Object(I.a)(e.button,e.homeLink),children:Object(A.jsx)(b.a,{variant:"h6",children:"Basic Flashcards"})})}),K,H]});return Object(A.jsxs)(y.a,{position:"sticky",children:[G,n?Q:X]})}function W(e){var t=Object(T.h)().pathname;return N.a.isAuthenticated()?Object(A.jsx)(T.b,Object(u.a)({},e)):Object(A.jsx)(T.a,{to:{pathname:z.a.login,search:"?continue=".concat(encodeURIComponent(t))}})}var R=n(168);function J(e){var t=e.delay,n=void 0===t?300:t,c=Object(a.useState)(n<=0),r=Object(o.a)(c,2),s=r[0],i=r[1];return Object(a.useEffect)((function(){var e=setTimeout((function(){i(!0)}),n);return function(){clearTimeout(e)}}),[n]),s?Object(A.jsx)(R.a,{color:"secondary"}):Object(A.jsx)(A.Fragment,{})}var D=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(14)]).then(n.bind(null,388))})),M=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(13)]).then(n.bind(null,365))})),V=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(2),n.e(10),n.e(8)]).then(n.bind(null,386))})),q=Object(a.lazy)((function(){return Promise.all([n.e(7),n.e(17)]).then(n.bind(null,385))})),G=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(15)]).then(n.bind(null,389))})),$=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(16)]).then(n.bind(null,390))})),H=Object(a.lazy)((function(){return n.e(9).then(n.bind(null,393))})),K=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(11)]).then(n.bind(null,383))})),Q=Object(a.lazy)((function(){return Promise.all([n.e(18),n.e(12)]).then(n.bind(null,391))}));function X(){var e=Object(a.useContext)(i.a);return Object(A.jsx)(a.Suspense,{fallback:Object(A.jsx)(J,{}),children:Object(A.jsxs)(T.d,{children:[Object(A.jsx)(T.b,{exact:!0,path:z.a.home,children:e?Object(A.jsx)(T.a,{to:z.a.dashboard}):Object(A.jsx)(H,{})}),Object(A.jsx)(W,{path:z.a.accountSettings,children:Object(A.jsx)(D,{})}),Object(A.jsx)(W,{path:z.a.dashboard,children:Object(A.jsx)(V,{})}),Object(A.jsx)(T.b,{exact:!0,path:z.a.deckView,children:Object(A.jsx)(q,{})}),Object(A.jsx)(W,{path:z.a.deckAdd,children:Object(A.jsx)(M,{})}),Object(A.jsx)(W,{path:z.a.deckEdit,children:Object(A.jsx)(K,{})}),Object(A.jsx)(T.b,{path:z.a.deckSearch,children:Object(A.jsx)(Q,{})}),Object(A.jsx)(T.b,{path:z.a.registration,children:Object(A.jsx)($,{})}),Object(A.jsx)(T.b,{path:z.a.login,children:Object(A.jsx)(G,{})})]})})}function Y(){var e=Object(a.useState)(d),t=Object(o.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){var e=function(){c(d)};return document.addEventListener("localStorageServiceChange",e),function(){return document.removeEventListener("localStorageServiceChange",e)}}),[]),Object(A.jsx)(A.Fragment,{children:Object(A.jsxs)(i.a.Provider,{value:n,children:[Object(A.jsx)(s.a,{}),Object(A.jsxs)("div",{id:"app-content",children:[Object(A.jsx)(F,{}),Object(A.jsx)("div",{id:"page-container",children:Object(A.jsx)(X,{})})]})]})})}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Z=function(e){e&&e instanceof Function&&n.e(19).then(n.bind(null,384)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),a(e),c(e),r(e),o(e)}))};n(122),n(123),n(124),n(125);r.a.render(Object(A.jsx)(a.StrictMode,{children:Object(A.jsx)(P.a,{children:Object(A.jsx)(Y,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),Z()},15:function(e,t,n){"use strict";var a=n(31),c=n(32),r=new(function(){function e(){Object(a.a)(this,e)}return Object(c.a)(e,[{key:"getItem",value:function(e){return localStorage.getItem(e)}},{key:"removeItem",value:function(e){localStorage.removeItem(e),document.dispatchEvent(new Event("localStorageServiceChange"))}},{key:"setItem",value:function(e,t){localStorage.setItem(e,t),document.dispatchEvent(new Event("localStorageServiceChange"))}}]),e}());t.a=r},33:function(e,t,n){"use strict";var a=n(0),c=Object(a.createContext)(null);t.a=c},40:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(23),c=n.n(a),r=n(41),o=n(31),s=n(32),i=n(47),u=n(15),l=new(function(){function e(t){Object(o.a)(this,e),this.http=t}return Object(s.a)(e,[{key:"logIn",value:function(){var e=Object(r.a)(c.a.mark((function e(t,n){var a,r,o,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.post("/auth/access-tokens",{username:t,password:n});case 2:return a=e.sent,r=a.data,o=r.accessToken,s=r.decodedAccessToken,u.a.setItem("accessToken",o),u.a.setItem("accessTokenPayload",JSON.stringify(s)),u.a.setItem("user",JSON.stringify({id:s.sub,username:t})),e.abrupt("return",s);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"logOut",value:function(){var e=Object(r.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u.a.removeItem("accessToken"),u.a.removeItem("accessTokenPayload"),u.a.removeItem("user");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"verifyAccessToken",value:function(){var e=Object(r.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.http.get("/auth/access-tokens/".concat(t));case 3:return e.abrupt("return",!0);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()},{key:"isAuthenticated",value:function(){return null!==u.a.getItem("accessToken")}},{key:"getCurrentUser",value:function(){var e=u.a.getItem("accessTokenPayload");return e?JSON.parse(e).sub:null}},{key:"changePassword",value:function(){var e=Object(r.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.put("/users/".concat(this.getCurrentUser(),"/password"),{currentPassword:t,newPassword:n});case 2:return e.next=4,this.logOut();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}())(i.a)},47:function(e,t,n){"use strict";var a=n(80),c=n.n(a),r=n(15),o=c.a.create({baseURL:"https://basic-flashcards.herokuapp.com",withCredentials:!0});o.interceptors.request.use((function(e){var t=r.a.getItem("accessToken");return t&&(e.headers.Authorization="Bearer ".concat(t)),e})),o.interceptors.response.use((function(e){return e}),(function(e){var t;throw 401===(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.status)&&r.a.removeItem("accessToken"),e})),t.a=o},69:function(e,t,n){"use strict";var a=n(31),c=n(32),r=n(47),o=n(15),s=new(function(){function e(t){Object(a.a)(this,e),this.http=t}return Object(c.a)(e,[{key:"create",value:function(e){return this.http.post("/users",e)}},{key:"getCurrentUser",value:function(){var e=o.a.getItem("user");return e?JSON.parse(e):null}}]),e}())(r.a);t.a=s},78:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(30),c=n(127);function r(){var e=Object(a.a)();return Object(c.a)(e.breakpoints.down("xs"),{noSsr:!0})}},97:function(e,t,n){}},[[126,5,6]]]);
//# sourceMappingURL=main.ba378b19.chunk.js.map